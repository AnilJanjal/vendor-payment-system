/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},n(e)}function e(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),t.push.apply(t,r)}return t}function t(n){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?e(Object(o),!0).forEach(function(e){r(n,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}function r(e,t,r){return(t=function(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}localStorage.removeItem("vendors");var o={login:function(n,e){return"aniljanjal2000@gmail.com"===n&&"aniljanjal2000@gmail.com"===e&&(localStorage.setItem("isAuthenticated","true"),!0)},logout:function(){localStorage.removeItem("isAuthenticated")},isAuthenticated:function(){return"true"===localStorage.getItem("isAuthenticated")},getVendors:function(){var n=localStorage.getItem("vendors");return n?JSON.parse(n):[]},saveVendors:function(n){localStorage.setItem("vendors",JSON.stringify(n))},addVendor:function(n){var e=this.getVendors(),r=t(t({},n),{},{id:Date.now().toString()});return e.push(r),this.saveVendors(e),r},updateVendor:function(n){var e=this.getVendors(),t=e.findIndex(function(e){return e.id===n.id});-1!==t&&(e[t]=n,this.saveVendors(e))},deleteVendor:function(n){var e=this.getVendors().filter(function(e){return e.id!==n});this.saveVendors(e)}};function a(n,e){var t="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=function(n,e){if(n){if("string"==typeof n)return i(n,e);var t={}.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(n,e):void 0}}(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,o=function(){};return{s:o,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,u=!1;return{s:function(){t=t.call(n)},n:function(){var n=t.next();return c=n.done,n},e:function(n){u=!0,a=n},f:function(){try{c||null==t.return||t.return()}finally{if(u)throw a}}}}function i(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function c(){var n,e,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function a(t,r,o,a){var c=r&&r.prototype instanceof s?r:s,d=Object.create(c.prototype);return u(d,"_invoke",function(t,r,o){var a,c,u,s=0,d=o||[],l=!1,p={p:0,n:0,v:n,a:f,f:f.bind(n,4),d:function(e,t){return a=e,c=0,u=n,p.n=t,i}};function f(t,r){for(c=t,u=r,e=0;!l&&s&&!o&&e<d.length;e++){var o,a=d[e],f=p.p,y=a[2];t>3?(o=y===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=n):a[0]<=f&&((o=t<2&&f<a[1])?(c=0,p.v=r,p.n=a[1]):f<y&&(o=t<3||a[0]>r||r>y)&&(a[4]=t,a[5]=r,p.n=y,c=0))}if(o||t>1)return i;throw l=!0,r}return function(o,d,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===d&&f(d,y),c=d,u=y;(e=c<2?n:u)||!l;){a||(c?c<3?(c>1&&(p.n=-1),f(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=n}else if((e=(l=p.n<0)?u:t.call(r,p))!==i)break}catch(e){a=n,c=1,u=e}finally{s=1}}return{value:e,done:l}}}(t,o,a),!0),d}var i={};function s(){}function d(){}function l(){}e=Object.getPrototypeOf;var p=[][r]?e(e([][r]())):(u(e={},r,function(){return this}),e),f=l.prototype=s.prototype=Object.create(p);function y(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,l):(n.__proto__=l,u(n,o,"GeneratorFunction")),n.prototype=Object.create(f),n}return d.prototype=l,u(f,"constructor",l),u(l,"constructor",d),d.displayName="GeneratorFunction",u(l,o,"GeneratorFunction"),u(f),u(f,o,"Generator"),u(f,r,function(){return this}),u(f,"toString",function(){return"[object Generator]"}),(c=function(){return{w:a,m:y}})()}function u(n,e,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}u=function(n,e,t,r){function a(e,t){u(n,e,function(n){return this._invoke(e,t,n)})}e?o?o(n,e,{value:t,enumerable:!r,configurable:!r,writable:!r}):n[e]=t:(a("next",0),a("throw",1),a("return",2))},u(n,e,t,r)}function s(n,e,t,r,o,a,i){try{var c=n[a](i),u=c.value}catch(n){return void t(n)}c.done?e(u):Promise.resolve(u).then(r,o)}function d(n){return function(){var e=this,t=arguments;return new Promise(function(r,o){var a=n.apply(e,t);function i(n){s(a,r,o,i,c,"next",n)}function c(n){s(a,r,o,i,c,"throw",n)}i(void 0)})}}var l,p,f={accountBalances:{"Account 1":2e5,"Account 2":2e5},paymentRules:{getBaseAmount:function(n){var e=parseInt(n);return e>=1&&e<=5?100:e>=6&&e<=10?200:0},getPaymentSchedule:function(n){var e=parseInt(n);return e>=1&&e<=5?"weekly":e>=6&&e<=10?"biweekly":"on-demand"},getDefaultAccount:function(n){var e=parseInt(n);return e>=1&&e<=10?"Account 1":"Account 2"}},processScheduledPayments:function(){var n=arguments,e=this;return d(c().m(function t(){var r,a,i,u,s;return c().w(function(t){for(;;)switch(t.n){case 0:if(r=n.length>0&&void 0!==n[0]&&n[0],a=new Date,console.log("Running payment check on ".concat(a.toDateString())),r||5===a.getDay()){t.n=1;break}return console.log("Not Friday - skipping payment processing"),t.a(2,{processed:0,skipped:0,pending:0});case 1:if(i=o.getVendors(),u={processed:0,skipped:0,pending:e.getPendingPayments().length},s=[],i.forEach(function(n){if("on-demand"!==e.paymentRules.getPaymentSchedule(n.id))if(r||n.nextPaymentDate&&new Date(n.nextPaymentDate).toDateString()===a.toDateString()){var t=e.paymentRules.getBaseAmount(n.id);s.push(e.createPayment(n,t))}else u.skipped++;else u.skipped++}),!(s.length>0)){t.n=3;break}return t.n=2,e.processPayments(s);case 2:u.processed=s.filter(function(n){return"completed"===n.status}).length,u.pending=e.getPendingPayments().length;case 3:return t.a(2,u)}},t)}))()},processOnDemandPayment:function(n,e){var t=this;return d(c().m(function r(){var a,i,u;return c().w(function(r){for(;;)switch(r.n){case 0:if(a=o.getVendors().find(function(e){return e.id===n})){r.n=1;break}return r.a(2,!1);case 1:return"on-demand"!==(i=t.paymentRules.getPaymentSchedule(n))&&confirm("".concat(a.name," is scheduled for ").concat(i," payments. Skip next scheduled payment?"))&&(a.lastPaymentDate=new Date,a.nextPaymentDate=t.getNextPaymentDate(n),o.updateVendor(a)),u=t.createPayment(a,e),r.a(2,t.processPayment(u))}},r)}))()},retryPaymentForVendor:function(n){var e=this;return d(c().m(function t(){var r,o;return c().w(function(t){for(;;)switch(t.n){case 0:if(r=e.pendingPayments.find(function(e){return e.vendorId===n})){t.n=1;break}return t.a(2,!1);case 1:return t.n=2,e.processPayment(r);case 2:return(o=t.v)&&(e.pendingPayments=e.pendingPayments.filter(function(e){return e.vendorId!==n}),localStorage.setItem("pendingPayments",JSON.stringify(e.pendingPayments))),t.a(2,o)}},t)}))()},createPayment:function(n,e){return{vendorId:n.id,amount:e,date:new Date,account:n.account,status:"pending"}},processPayments:function(n){var e=this;return d(c().m(function t(){var r,o,i,u;return c().w(function(t){for(;;)switch(t.p=t.n){case 0:r=a(n),t.p=1,r.s();case 2:if((o=r.n()).done){t.n=4;break}return i=o.value,t.n=3,e.processPayment(i);case 3:t.n=2;break;case 4:t.n=6;break;case 5:t.p=5,u=t.v,r.e(u);case 6:return t.p=6,r.f(),t.f(6);case 7:return t.a(2)}},t,null,[[1,5,6,7]])}))()},processPayment:function(n){var e=this;return d(c().m(function t(){var r;return c().w(function(t){for(;;)switch(t.n){case 0:if(!(e.accountBalances[n.account]>=n.amount)){t.n=1;break}return e.accountBalances[n.account]-=n.amount,n.status="completed",e.updateVendorPaymentDate(n.vendorId),e.updateAccountBalancesUI(),t.a(2,!0);case 1:return n.status="pending",e.addToPendingPayments(n),(r=o.getVendors().find(function(e){return e.id===n.vendorId}))&&alert("Insufficient funds in ".concat(n.account," to pay ").concat(r.name,". Payment moved to pending.")),t.a(2,!1);case 2:return t.a(2)}},t)}))()},updateVendorPaymentDate:function(n){var e=o.getVendors().find(function(e){return e.id===n});e&&(e.lastPaymentDate=new Date,e.nextPaymentDate=this.getNextPaymentDate(n),e.pendingPayment=!1,o.updateVendor(e))},getNextPaymentDate:function(n){var e=new Date,t=this.paymentRules.getPaymentSchedule(n);return"weekly"===t?e.setDate(e.getDate()+7):"biweekly"===t&&e.setDate(e.getDate()+14),e},getWeekNumber:function(n){var e=new Date(n.getFullYear(),0,1),t=(n.getTime()-e.getTime())/864e5;return Math.ceil((t+e.getDay()+1)/7)},pendingPayments:[],addToPendingPayments:function(n){this.pendingPayments.push(n),localStorage.setItem("pendingPayments",JSON.stringify(this.pendingPayments))},getPendingPayments:function(){var n=localStorage.getItem("pendingPayments");return this.pendingPayments=n?JSON.parse(n):[],this.pendingPayments},retryPendingPayments:function(){var n=this;return d(c().m(function e(){var t,r,o,i,u;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:t=n.getPendingPayments(),r=a(t),e.p=1,r.s();case 2:if((o=r.n()).done){e.n=4;break}if(i=o.value,!(n.accountBalances[i.account]>=i.amount)){e.n=3;break}return e.n=3,n.processPayment(i);case 3:e.n=2;break;case 4:e.n=6;break;case 5:e.p=5,u=e.v,r.e(u);case 6:return e.p=6,r.f(),e.f(6);case 7:n.updateAccountBalancesUI();case 8:return e.a(2)}},e,null,[[1,5,6,7]])}))()},updateAccountBalancesUI:function(){var n=document.querySelector("#account-balances div:nth-child(1) p"),e=document.querySelector("#account-balances div:nth-child(2) p");n&&(n.textContent="$".concat(this.accountBalances["Account 1"].toLocaleString())),e&&(e.textContent="$".concat(this.accountBalances["Account 2"].toLocaleString()))}};function y(n){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},y(n)}function m(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),t.push.apply(t,r)}return t}function v(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?m(Object(t),!0).forEach(function(e){g(n,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}function g(n,e,t){return(e=function(n){var e=function(n){if("object"!=y(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var t=e.call(n,"string");if("object"!=y(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==y(e)?e:e+""}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function b(){var n,e,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function a(t,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return h(s,"_invoke",function(t,r,o){var a,c,u,s=0,d=o||[],l=!1,p={p:0,n:0,v:n,a:f,f:f.bind(n,4),d:function(e,t){return a=e,c=0,u=n,p.n=t,i}};function f(t,r){for(c=t,u=r,e=0;!l&&s&&!o&&e<d.length;e++){var o,a=d[e],f=p.p,y=a[2];t>3?(o=y===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=n):a[0]<=f&&((o=t<2&&f<a[1])?(c=0,p.v=r,p.n=a[1]):f<y&&(o=t<3||a[0]>r||r>y)&&(a[4]=t,a[5]=r,p.n=y,c=0))}if(o||t>1)return i;throw l=!0,r}return function(o,d,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===d&&f(d,y),c=d,u=y;(e=c<2?n:u)||!l;){a||(c?c<3?(c>1&&(p.n=-1),f(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=n}else if((e=(l=p.n<0)?u:t.call(r,p))!==i)break}catch(e){a=n,c=1,u=e}finally{s=1}}return{value:e,done:l}}}(t,o,a),!0),s}var i={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var d=[][r]?e(e([][r]())):(h(e={},r,function(){return this}),e),l=s.prototype=c.prototype=Object.create(d);function p(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,s):(n.__proto__=s,h(n,o,"GeneratorFunction")),n.prototype=Object.create(l),n}return u.prototype=s,h(l,"constructor",s),h(s,"constructor",u),u.displayName="GeneratorFunction",h(s,o,"GeneratorFunction"),h(l),h(l,o,"Generator"),h(l,r,function(){return this}),h(l,"toString",function(){return"[object Generator]"}),(b=function(){return{w:a,m:p}})()}function h(n,e,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}h=function(n,e,t,r){function a(e,t){h(n,e,function(n){return this._invoke(e,t,n)})}e?o?o(n,e,{value:t,enumerable:!r,configurable:!r,writable:!r}):n[e]=t:(a("next",0),a("throw",1),a("return",2))},h(n,e,t,r)}function P(n,e,t,r,o,a,i){try{var c=n[a](i),u=c.value}catch(n){return void t(n)}c.done?e(u):Promise.resolve(u).then(r,o)}function w(n){return function(){var e=this,t=arguments;return new Promise(function(r,o){var a=n.apply(e,t);function i(n){P(a,r,o,i,c,"next",n)}function c(n){P(a,r,o,i,c,"throw",n)}i(void 0)})}}var k=null,x=!1;function S(){return(S=w(b().m(function n(){var e,t,r;return b().w(function(n){for(;;)switch(n.p=n.n){case 0:if(n.p=0,Office.context.host!==Office.HostType.Excel){n.n=1;break}if(null===(e=Office.context.requirements)||void 0===e||null===(t=e.isSetSupported)||void 0===t||!t.call(e,"ExcelApi",1.1)){n.n=1;break}return x=!0,n.n=1,O();case 1:f.getPendingPayments(),setInterval(function(){return f.processScheduledPayments()},864e5),D(),n.n=3;break;case 2:n.p=2,r=n.v,console.error("Initialization failed:",r),D();case 3:return n.a(2)}},n,null,[[0,2]])}))).apply(this,arguments)}function O(){return E.apply(this,arguments)}function E(){return E=w(b().m(function n(){var e;return b().w(function(n){for(;;)switch(n.p=n.n){case 0:if(x){n.n=1;break}return n.a(2);case 1:return n.p=1,n.n=2,Excel.run(function(){var n=w(b().m(function n(e){var t,r;return b().w(function(n){for(;;)switch(n.n){case 0:try{t=e.workbook.worksheets.getItem("Vendors")}catch(n){(t=e.workbook.worksheets.add("Vendors")).getRange("A1:D1").values=[["Vendor Name","Payment Type","Account","Next Payment Date"]],t.getRange("A1:D1").format.font.bold=!0}return(r=o.getVendors()).length>0&&(t.getRange("A2:D"+(r.length+1)).values=r.map(function(n){return[n.name,n.paymentType,n.account,n.nextPaymentDate?new Date(n.nextPaymentDate).toLocaleDateString():"N/A"]})),n.n=1,e.sync();case 1:return n.a(2)}},n)}));return function(e){return n.apply(this,arguments)}}());case 2:n.n=4;break;case 3:n.p=3,e=n.v,console.warn("Excel table initialization failed:",e),x=!1;case 4:return n.a(2)}},n,null,[[1,3]])})),E.apply(this,arguments)}function D(){return I.apply(this,arguments)}function I(){return(I=w(b().m(function n(){var e,t;return b().w(function(n){for(;;)switch(n.n){case 0:null===(e=l)||void 0===e||e.removeEventListener("click",V),null===(t=p)||void 0===t||t.removeEventListener("click",T),o.isAuthenticated()?L():B();case 1:return n.a(2)}},n)}))).apply(this,arguments)}function j(){return A.apply(this,arguments)}function A(){return A=w(b().m(function n(){var e;return b().w(function(n){for(;;)switch(n.p=n.n){case 0:if(x){n.n=1;break}return n.a(2);case 1:return n.p=1,n.n=2,Excel.run(function(){var n=w(b().m(function n(e){var t,r;return b().w(function(n){for(;;)switch(n.n){case 0:return t=e.workbook.worksheets.getItem("Vendors"),(r=o.getVendors()).length>0?t.getRange("A2:D"+(r.length+1)).clear():t.getRange("A2:D2").clear(),r.forEach(function(n,e){t.getRange("A".concat(e+2,":D").concat(e+2)).values=[[n.name,n.paymentType,n.account,n.nextPaymentDate?new Date(n.nextPaymentDate).toLocaleDateString():"N/A"]]}),t.getUsedRange().format.autofitColumns(),n.n=1,e.sync();case 1:return n.a(2)}},n)}));return function(e){return n.apply(this,arguments)}}());case 2:n.n=4;break;case 3:n.p=3,e=n.v,console.warn("Excel sync failed:",e),x=!1;case 4:return n.a(2)}},n,null,[[1,3]])})),A.apply(this,arguments)}function B(){var n,e=document.getElementById("container");e&&(e.innerHTML='\n        <div id="login-section" class="banking-container">\n            <div class="banking-header">\n                <img src="../../assets/vendor.jpg" class="banking-logo" alt="Bank Logo">\n                <h2 class="banking-title">Vendor Payment Portal</h2>\n                <p class="banking-subtitle">Secure access to your payment dashboard</p>\n            </div>\n            \n            <div class="banking-input">\n                <label for="username">User ID</label>\n                <input id="username" type="text" placeholder="Enter your user ID">\n            </div>\n            \n            <div class="banking-input">\n                <label for="password">Password</label>\n                <input id="password" type="password" placeholder="Enter your password">\n            </div>\n            \n            <button id="login-button" class="banking-button">Sign In</button>\n            <p id="login-error" class="banking-error" style="display: none;"></p>\n            \n            <div class="banking-footer">\n                <p>Need help? Contact your system administrator</p>\n            </div>\n        </div>\n    ',null===(n=l=document.getElementById("login-button"))||void 0===n||n.addEventListener("click",V))}function V(){var n,e,t=null===(n=document.getElementById("username"))||void 0===n?void 0:n.value,r=null===(e=document.getElementById("password"))||void 0===e?void 0:e.value,a=document.getElementById("login-error");t&&r?o.login(t,r)?L():a&&(a.textContent="Invalid credentials",a.style.display="block"):a&&(a.textContent="Please enter both username and password",a.style.display="block")}function T(){o.logout(),D()}function L(){var n,e,t,r,a,i,c,u,s=document.getElementById("container");s&&(s.innerHTML='\n        <div class="banking-container" style="max-width: 800px;">\n            <div class="banking-header">\n                <img src="../../assets/vendor .jpg" class="banking-logo" alt="Vendor Logo">\n                <h2 class="banking-title">Vendor Management System</h2>\n                <button id="logout-button" class="banking-button" \n                    style="position: absolute; top: 20px; right: 20px; width: auto; padding: 8px 16px;">\n                    Sign Out\n                </button>\n            </div>\n            \n            <div style="margin-top: 20px;">\n                <div style="display: flex; gap: 10px; margin-bottom: 20px;">\n                    <button id="add-vendor-button" class="banking-button">\n                        + Add New Vendor\n                    </button>\n                    <button id="process-payments" class="banking-button">\n                        Process Payments\n                    </button>\n                    <button id="retry-pending" class="banking-button">\n                        Retry Pending\n                    </button>\n                </div>\n                \n                <div id="account-balances" style="display: flex; gap: 20px; margin-bottom: 20px;">\n                    <div class="account-balance">\n                        <h3>Account 1</h3>\n                        <p>$'.concat(f.accountBalances["Account 1"].toLocaleString(),'</p>\n                    </div>\n                    <div class="account-balance">\n                        <h3>Account 2</h3>\n                        <p>$').concat(f.accountBalances["Account 2"].toLocaleString(),'</p>\n                    </div>\n                </div>\n                \n                <div id="vendors-list" style="max-height: 400px; overflow-y: auto;">\n                    ').concat(N(),'\n                </div>\n                \n                <div id="pending-payments" style="margin-top: 30px;">\n                    <h3>Pending Payments</h3>\n                    <div id="pending-list">\n                        ').concat(R(),"\n                    </div>\n                </div>\n            </div>\n        </div>\n    "),null===(r=document.getElementById("add-vendor-button"))||void 0===r||r.addEventListener("click",function(){return H()}),null===(a=document.getElementById("vendors-list"))||void 0===a||a.addEventListener("click",function(n){var e,t=n.target,r=t.getAttribute("data-id");if(t.classList.contains("delete-vendor")&&r)k=r,(e=document.getElementById("confirm-dialog"))&&(e.style.display="flex");else if(t.classList.contains("edit-vendor")&&r){var a=o.getVendors().find(function(n){return n.id===r});a&&H(a)}else t.classList.contains("pay-now")&&r&&function(n){C.apply(this,arguments)}(r)}),null===(i=document.getElementById("pending-list"))||void 0===i||i.addEventListener("click",function(n){var e=n.target,t=e.getAttribute("data-id");e.classList.contains("retry-single")&&t&&f.retryPaymentForVendor(t).then(function(){G(),_(),F(),j()})}),null===(c=document.getElementById("confirm-delete"))||void 0===c||c.addEventListener("click",function(){k&&(function(n){try{o.deleteVendor(n),j();var e=document.querySelector('.vendor-card[data-vendor-id="'.concat(n,'"]'));if(null==e||e.remove(),0===o.getVendors().length){var t=document.getElementById("vendors-list");t&&(t.innerHTML='\n                    <div style="text-align: center; padding: 20px; color: #666;">\n                        No vendors found. Click "Add New Vendor" to create one.\n                    </div>\n                ')}}catch(n){console.error("Error deleting vendor:",n),alert("Error deleting vendor. Please try again.")}}(k),M())}),null===(u=document.getElementById("cancel-delete"))||void 0===u||u.addEventListener("click",M),null===(n=p=document.getElementById("logout-button"))||void 0===n||n.addEventListener("click",T),null===(e=document.getElementById("process-payments"))||void 0===e||e.addEventListener("click",w(b().m(function n(){var e,t,r,o;return b().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,f.processScheduledPayments(!0);case 1:return e=n.v,t='\n            <div class="payment-results" style="margin: 15px 0; padding: 10px; background: #f3f3f3; border-radius: 4px;">\n                <h4 style="margin: 0 0 10px 0;">Payment Results</h4>\n                <p>Processed: '.concat(e.processed," payments</p>\n                <p>Skipped: ").concat(e.skipped," vendors</p>\n                <p>Pending: ").concat(e.pending," payments</p>\n            </div>\n        "),(r=document.getElementById("pending-payments"))&&(r.insertAdjacentHTML("afterbegin",t),setTimeout(function(){var n=document.querySelector(".payment-results");null==n||n.remove()},5e3)),G(),_(),F(),n.n=2,j();case 2:n.n=4;break;case 3:n.p=3,o=n.v,console.error("Error processing payments:",o),alert("Error processing payments. Check console for details.");case 4:return n.a(2)}},n,null,[[0,3]])}))),null===(t=document.getElementById("retry-pending"))||void 0===t||t.addEventListener("click",w(b().m(function n(){return b().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,f.retryPendingPayments();case 1:_(),G(),F(),j();case 2:return n.a(2)}},n)}))))}function N(){var n=o.getVendors();return 0===n.length?'\n            <div style="text-align: center; padding: 20px; color: #666;">\n                No vendors found. Click "Add New Vendor" to create one.\n            </div>\n        ':n.map(function(n){return'\n        <div class="vendor-card" data-vendor-id="'.concat(n.id,'">\n            <div style="display: flex; justify-content: space-between; align-items: center;">\n                <div>\n                    <h3 style="margin: 0; color: #0078d4;">').concat(n.name,'</h3>\n                    <p style="margin: 5px 0; color: #666;">\n                        Payment: ').concat(n.paymentType," | Account: ").concat(n.account,"\n                    </p>\n                    ").concat(n.nextPaymentDate?'\n                    <p style="margin: 5px 0; color: #666; font-size: 0.9em;">\n                        Next payment: '.concat(new Date(n.nextPaymentDate).toLocaleDateString(),"\n                    </p>\n                    "):"","\n                    ").concat(n.pendingPayment?'\n                    <p style="margin: 5px 0; color: #d13438; font-size: 0.9em;">\n                        Payment pending (insufficient funds)\n                    </p>\n                    ':"",'\n                </div>\n                <div style="display: flex; align-items: center;">\n                    <button class="pay-now" data-id="').concat(n.id,'" \n                        style="background: none; border: none; color: #0078d4; cursor: pointer; margin-right: 10px;">\n                        Pay Now\n                    </button>\n                    <button class="edit-vendor" data-id="').concat(n.id,'" \n                        style="background: none; border: none; color: #0078d4; cursor: pointer; margin-right: 10px;">\n                        Edit\n                    </button>\n                    <button class="delete-vendor" data-id="').concat(n.id,'" \n                        style="background: none; border: none; color: #d13438; cursor: pointer;">\n                        Delete\n                    </button>\n                </div>\n            </div>\n        </div>\n    ')}).join("")}function R(){var n=f.getPendingPayments(),e=o.getVendors();return 0===n.length?'<p style="color: #666;">No pending payments</p>':n.map(function(n){var t=e.find(function(e){return e.id===n.vendorId});return'\n            <div class="pending-payment" style="padding: 10px; border-bottom: 1px solid #eee;">\n                <div style="display: flex; justify-content: space-between;">\n                    <div>\n                        <strong>'.concat((null==t?void 0:t.name)||"Unknown Vendor","</strong>\n                        <p>Amount: $").concat(n.amount," | Account: ").concat(n.account,"</p>\n                        <p>Date: ").concat(new Date(n.date).toLocaleDateString(),'</p>\n                    </div>\n                    <button class="retry-single" data-id="').concat(n.vendorId,'" \n                        style="background: none; border: none; color: #0078d4; cursor: pointer;">\n                        Retry\n                    </button>\n                </div>\n            </div>\n        ')}).join("")}function C(){return(C=w(b().m(function n(e){var t,r,a;return b().w(function(n){for(;;)switch(n.n){case 0:if(t=o.getVendors().find(function(n){return n.id===e})){n.n=1;break}return n.a(2);case 1:if(r=f.paymentRules.getBaseAmount(e),"on-demand"!==f.paymentRules.getPaymentSchedule(e)){n.n=3;break}if(null!==(a=prompt("Enter payment amount for ".concat(t.name,":"),r.toString()))){n.n=2;break}return n.a(2);case 2:if(!((r=parseFloat(a)||0)<=0)){n.n=3;break}return alert("Please enter a valid positive amount"),n.a(2);case 3:return n.n=4,f.processOnDemandPayment(e,r);case 4:n.v&&(G(),_(),F(),j());case 5:return n.a(2)}},n)}))).apply(this,arguments)}function G(){var n=document.querySelector("#account-balances div:nth-child(1) p"),e=document.querySelector("#account-balances div:nth-child(2) p");n&&(n.textContent="$".concat(f.accountBalances["Account 1"].toLocaleString())),e&&(e.textContent="$".concat(f.accountBalances["Account 2"].toLocaleString()))}function _(){var n=document.getElementById("vendors-list");n&&(n.innerHTML=N())}function F(){var n=document.getElementById("pending-list");n&&(n.innerHTML=R())}function M(){var n=document.getElementById("confirm-dialog");n&&(n.style.display="none"),k=null}function H(n){var e,t,r=document.getElementById("container");r&&(r.innerHTML='\n        <div class="banking-container" style="max-width: 600px;">\n            <div class="banking-header">\n                <h2 class="banking-title">'.concat(n?"Edit Vendor":"Add New Vendor",'</h2>\n            </div>\n            \n            <div style="margin-top: 20px;">\n                <div class="banking-input">\n                    <label>Vendor Name</label>\n                    <input id="vendor-name" type="text" value="').concat((null==n?void 0:n.name)||"",'" \n                        placeholder="Enter vendor name" style="width: 100%;">\n                </div>\n                \n                <div class="banking-input">\n                    <label>Payment Type</label>\n                    <select id="payment-type" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px;">\n                        <option value="Weekly" ').concat("Weekly"===(null==n?void 0:n.paymentType)?"selected":"",'>Weekly</option>\n                        <option value="Biweekly" ').concat("Biweekly"===(null==n?void 0:n.paymentType)?"selected":"",'>Biweekly</option>\n                        <option value="On-Demand" ').concat("On-Demand"===(null==n?void 0:n.paymentType)?"selected":"",'>On-Demand</option>\n                    </select>\n                </div>\n                \n                <div class="banking-input">\n                    <label>Assigned Account</label>\n                    <select id="assigned-account" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px;">\n                        <option value="Account 1" ').concat("Account 1"===(null==n?void 0:n.account)?"selected":"",'>Account 1</option>\n                        <option value="Account 2" ').concat("Account 2"===(null==n?void 0:n.account)?"selected":"",'>Account 2</option>\n                    </select>\n                </div>\n                \n                <div style="display: flex; gap: 10px; margin-top: 30px;">\n                    <button id="save-vendor" class="banking-button" style="flex: 1;">\n                        ').concat(n?"Update":"Save",' Vendor\n                    </button>\n                    <button id="cancel-form" class="banking-button" \n                        style="flex: 1; background: #f3f3f3; color: #333; border: 1px solid #ddd;">\n                        Cancel\n                    </button>\n                </div>\n            </div>\n        </div>\n    '),null===(e=document.getElementById("save-vendor"))||void 0===e||e.addEventListener("click",w(b().m(function e(){var t,r,a,i;return b().w(function(e){for(;;)switch(e.n){case 0:if(t=document.getElementById("vendor-name"),r=document.getElementById("payment-type"),a=document.getElementById("assigned-account"),t.value.trim()){e.n=1;break}return alert("Please enter a vendor name"),e.a(2);case 1:return n?(i=v(v({},n),{},{name:t.value.trim(),paymentType:r.value,account:a.value}),o.updateVendor(i)):o.addVendor({name:t.value.trim(),paymentType:r.value,account:a.value}),e.n=2,j();case 2:L();case 3:return e.a(2)}},e)}))),null===(t=document.getElementById("cancel-form"))||void 0===t||t.addEventListener("click",L))}Office.onReady(function(){!function(){S.apply(this,arguments)}()})}();
//# sourceMappingURL=taskpane.js.map